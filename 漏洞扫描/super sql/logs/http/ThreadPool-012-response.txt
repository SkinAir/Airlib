HTTP/1.1 200 OK
Date: Thu, 03 Mar 2022 10:37:56 GMT
Server: Apache
Set-Cookie: PHPSESSID=4lfaeg68ta818nm6r5fiiktjj3; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: private
Pragma: no-cache
X-Powered-By: ThinkPHP
Content-Length: 6819
Content-Type: text/html; charset=utf-8

<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>西太湖数字政务平台</title>
		<link href="/Public/Ins/css/bootstrap.min.css" rel="stylesheet">
		<link href="/Public/Ins/font-awesome/css/font-awesome.css" rel="stylesheet">
		<link href="/Public/Ins/css/plugins/toastr/toastr.min.css" rel="stylesheet">

		<link href="/Public/Ins/css/style.css" rel="stylesheet">
		<link href="/Public/Ins/css/platform.css" rel="stylesheet">
		<link href="/Public/Ins/css/assist.css" rel="stylesheet">
		
	</head>
	<script type="text/javascript">
	var upload_url = "/index.php?m=&c=Public&a=upload";
	var del_url = "/index.php?m=&c=Public&a=del_file";
	var app_path = "";
	var cookie_prefix = "";
	var link_select = "/index.php?m=&c=Popup&a=link_select";
	// var _hmt = _hmt || [];
	// (function() {
	// 	var hm = document.createElement("script");
	// 	hm.src = "//hm.baidu.com/hm.js?2a935166b0c9b73fef3c8bae58b95fe4";
	// 	var s = document.getElementsByTagName("script")[0];
	// 	s.parentNode.insertBefore(hm, s);
	// })(); 
</script>
	<body class="white-bg">
		
	<nav class="navbar navbar-default row" role="navigation" id="top_menu" style="margin-bottom:8px;">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header" style="width:240px;height:78px;background-image:url(/Public/Ins/img/LOGO.png);background-repeat:no-repeat;background-position:center;background-size: contain;">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-6">
				<span class="sr-only">Toggle navigation</span>
				<i class="fa fa-bars fa-lg"></i>
			</button>
			<div class="hidden-xs">
				&nbsp;
			</div>
			<!-- <a href="/index.php?m=&c=index&a=index" class="navbar-brand">西太湖数字政务平台</a> -->
		</div>
	</nav>
	<div style="width:80%;margin:auto;">
		<div class="text-center" style="font-size:32px;padding:8px 0;">密码重置</div>
		<form class="form-horizontal" role="form" id="form_data"  method='post'>
			<div class="form-group">
				<label class="col-sm-4 control-label">选择用户类型：</label>
				<div class="col-sm-4">
					<select class="form-control" id="usertype" name="usertype" onchange="changeUserType()">
						<option value="0">请选择</option>
						<!-- <option value="1">管理员用户</option> -->
						<option value="2">政府用户</option>
						<!-- <option value="3">银行用户</option> -->
						<option value="4">企业用户</option>
					</select>
				</div>
				<div class="col-sm-4">
					<span class="help-block">您的用户类型</span>
				</div>
			</div>
			<div>
				<div class="form-group">
					<label class="col-sm-4 control-label">用户名：</label>
					<div class="col-sm-4">
						<input class="form-control" type="text" name="username" id="username">
					</div>
					<div class="col-sm-4">
						<span class="help-block">登录平台的用户名</span>
					</div>
				</div>
				<div class="form-group">
					<label class="col-sm-4 control-label">邮箱：</label>
					<div class="col-sm-4">
						<input class="form-control" type="text" name="email" id="email">
					</div>
					<div class="col-sm-4">
						<span class="help-block">用户注册时所填邮箱</span>
					</div>
				</div>
				<div class="form-group" id="socialCreditCode" style="display: none">
					<label class="col-sm-4 control-label">统一信用代码：</label>
					<div class="col-sm-4">
						<input class="form-control" type="text" name="creditCode" id="creditCode">
					</div>
					<div class="col-sm-4">
						<span class="help-block">企业统一信用代码</span>
					</div>
				</div>
				</div>
					<div class="form-group">
					<div class="col-sm-12 text-center" style="color:red;">
							<b>注意：密码重置后，旧密码将不可使用。<br>系统生成的新密码将通过邮件发送到您在用户注册时所填邮箱。</b>
					</div>
				</div>
			</div>
			
	    	<div class="form-group">
		    	<div class="col-sm-12 text-center" style="position:bottom">
		      		<button id="next_page" type="button" class="btn btn-primary btn-bulge" onclick="confirm()" style="margin-top:93px;margin-left:0;">重置密码</button>
		    	</div>
		  	</div>
		</form>
	</div>


		<!-- Mainly scripts -->
		<script src="/Public/Ins/js/jquery-3.5.1.js"></script>
		<script src="/Public/Ins/js/bootstrap.min.js"></script>
		<script src="/Public/Ins/js/plugins/metisMenu/jquery.metisMenu.js"></script>
		<script src="/Public/Ins/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

		<!-- Custom and plugin javascript -->
		<script src="/Public/Ins/js/inspinia.js"></script>
		<script src="/Public/Ins/js/common.js"></script>
		







<!--  -->

<script src="/Public/Ins/js/plugins/toastr/toastr.min.js"></script>
<script src="/Public/Ins/js/plugins/gritter/jquery.gritter.min.js"></script>
<script src="/Public/Ins/js/plugins/bootbox/bootbox.min.js"></script>

<script type="text/javascript">
	$(document).ready(function() {
				 
	}); 
</script>
		
	<script type="text/javascript">
		function confirm(){
			$('.has-error').removeClass("has-error");
			var usertype = $("#usertype").val();
			var checkRt = true;
			var username = $.trim($("#username").val());
			var email = $.trim($("#email").val());
			var creditCode = $.trim($("#creditCode").val());

			if (usertype == '0') {
				$('#usertype').parent().parent().addClass("has-error");
				checkRt = false;
			}

			var name_pattern = /^[a-zA-Z0-9]{4,20}$/;
			if(!name_pattern.test(username)){
				$('#username').parent().parent().addClass("has-error");
				checkRt = false;
			}

			var email_pattern = /^[\w\-\.]+@[\w\-\.]+(\.\w+)+$/;
			if(!email_pattern.test(email)){
				$('#email').parent().parent().addClass("has-error");
				checkRt = false;
			}

			if (usertype == "4") {
				if(creditCode.length == 0){
					$('#creditCode').parent().parent().addClass("has-error");
					checkRt = false;
				}
			}

			if(checkRt){
				$.ajax({
					type : "POST",
					url : "/index.php?m=&c=Public&a=reset_pw_confirm",
					data : {usertype:usertype,username:username,email:email,creditCode:creditCode},
					dataType : "json",
					success : function(data) {
						if (data.status == 1) {
							alert(data.errmsg);
						}else{
							alert(data.errmsg);
						}
					}
				});
			}

		}

		function changeUserType(){
			var usertype = $("#usertype").val();
			// alert(usertype);
			if (usertype == "4") {
				$("#socialCreditCode").show();
			} else {
				$("#socialCreditCode").hide();
			}
		}
	</script>

	</body>
</html>
